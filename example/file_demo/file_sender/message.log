
**************Begin new trust node proc****************************
{ "HEAD":{"tag":"MESG","version":65537,"sender_uuid":"request","receiver_uuid":"file_dealer","route":"file_trans","flow":"QUERY","state":"INIT","flag":"LOCAL","ljump":1,"rjump":1,"record_type":"FILE_TRANS","record_subtype":"REQUEST","record_num":1,"record_size":0,"expand_num":0,"expand_size":0,"msg_uuid":"253cefa089ff865885656b826f9cb8646dd2111265b0ae131181d73c8b8eedd5"},"RECORD":[{"uuid":"","filename":"tpmd_dev.c","requestor":""}],"EXPAND" :[]}

************************************************************
{ "HEAD":{"tag":"MESG","version":65537,"sender_uuid":"file_dealer","receiver_uuid":":file_client","route":"file_trans","flow":"QUERY","state":"DELIVER","flag":"NULL","ljump":2,"rjump":1,"record_type":"FILE_TRANS","record_subtype":"FILE_DATA","record_num":1,"record_size":0,"expand_num":1,"expand_size":0,"msg_uuid":"253cefa089ff865885656b826f9cb8646dd2111265b0ae131181d73c8b8eedd5"},"RECORD":[{"uuid":"2845f3d2635bf80b69e1c127ec4c41aa8e35531f91b7ff5d8170a552e0743962","filename":"tpmd_dev.c","total_size":8463,"record_no":16,"offset":8192,"data_size":271,"policy_data":"bV9yZXNwb25zZS5zaXplID0gMDsKICB0cG1kX3NvY2sgPSBOVUxMOwogIHJldHVybiAwOwp9Cgp2b2lkIF9fZXhpdCBjbGVhbnVwX3RwbV9tb2R1bGUodm9pZCkKewogIG1pc2NfZGVyZWdpc3RlcigmdHBtX2Rldik7CiAgdHBtZF9kaXNjb25uZWN0KCk7CiAgaWYgKHRwbV9yZXNwb25zZS5kYXRhICE9IE5VTEwpIGtmcmVlKHRwbV9yZXNwb25zZS5kYXRhKTsKfQoKbW9kdWxlX2luaXQoaW5pdF90cG1fbW9kdWxlKTsKbW9kdWxlX2V4aXQoY2xlYW51cF90cG1fbW9kdWxlKTsKCg"}],"EXPAND" :[{"data_size":0,"type":"MSG_EXPAND","subtype":"FLOW_TRACE","expand":{"record_num":1,"trace_record":["55c5ce299b107abd9760bb89d4992020087c99505c28360401742b1e3eedfa2e"]}}]}

************************************************************
{ "HEAD":{"tag":"MESG","version":65537,"sender_uuid":"file_dealer","receiver_uuid":":file_client","route":"file_trans","flow":"QUERY","state":"DELIVER","flag":"NULL","ljump":2,"rjump":1,"record_type":"FILE_TRANS","record_subtype":"FILE_DATA","record_num":1,"record_size":0,"expand_num":1,"expand_size":0,"msg_uuid":"253cefa089ff865885656b826f9cb8646dd2111265b0ae131181d73c8b8eedd5"},"RECORD":[{"uuid":"2845f3d2635bf80b69e1c127ec4c41aa8e35531f91b7ff5d8170a552e0743962","filename":"tpmd_dev.c","total_size":8463,"record_no":15,"offset":7680,"data_size":512,"policy_data":"dHBtX2lvY3RsLAp9OwoKc3RhdGljIHN0cnVjdCBtaXNjZGV2aWNlIHRwbV9kZXYgPSB7CiAgLm1pbm9yICAgICAgPSBUUE1fREVWSUNFX01JTk9SLCAKICAubmFtZSAgICAgICA9IFRQTV9ERVZJQ0VfSUQsIAogIC5mb3BzICAgICAgID0gJmZvcHMsCn07CgppbnQgX19pbml0IGluaXRfdHBtX21vZHVsZSh2b2lkKQp7CiAgaW50IHJlcyA9IG1pc2NfcmVnaXN0ZXIoJnRwbV9kZXYpOwogIGlmIChyZXMgIT0gMCkgewogICAgZXJyb3IoIm1pc2NfcmVnaXN0ZXIoKSBmYWlsZWQgZm9yIG1pbm9yICVkXG4iLCBUUE1fREVWSUNFX01JTk9SKTsKICAgIHJldHVybiByZXM7CiAgfQogIHByaW50aygidHBtZF9kZXY6IGlucHV0IHBhcmFtZXRlcnMgJXMgOiAlZFxuIix0cG1kX3NvY2tldF9uYW1lLHRwbWRfcG9ydCk7CiAgLyogaW5pdGlhbGl6ZSB2YXJpYWJsZXMgKi8KICBzZW1hX2luaXQoJnRwbV9tdXRleCwgMSk7CiAgbW9kdWxlX3N0YXRlID0gMDsKICB0cG1fcmVzcG9uc2UuZGF0YSA9IE5VTEw7CiAgdHA"}],"EXPAND" :[{"data_size":0,"type":"MSG_EXPAND","subtype":"FLOW_TRACE","expand":{"record_num":1,"trace_record":["55c5ce299b107abd9760bb89d4992020087c99505c28360401742b1e3eedfa2e"]}}]}

************************************************************
{ "HEAD":{"tag":"MESG","version":65537,"sender_uuid":"file_dealer","receiver_uuid":":file_client","route":"file_trans","flow":"QUERY","state":"DELIVER","flag":"NULL","ljump":2,"rjump":1,"record_type":"FILE_TRANS","record_subtype":"FILE_DATA","record_num":1,"record_size":0,"expand_num":1,"expand_size":0,"msg_uuid":"253cefa089ff865885656b826f9cb8646dd2111265b0ae131181d73c8b8eedd5"},"RECORD":[{"uuid":"2845f3d2635bf80b69e1c127ec4c41aa8e35531f91b7ff5d8170a552e0743962","filename":"tpmd_dev.c","total_size":8463,"record_no":14,"offset":7168,"data_size":512,"policy_data":"bW1hbmQoKGNoYXIqKWFyZywgY291bnQpID09IDApIHsKICAgICAgdHBtX3Jlc3BvbnNlLnNpemUgLT0gY29weV90b191c2VyKChjaGFyKilhcmcsIHRwbV9yZXNwb25zZS5kYXRhLCB0cG1fcmVzcG9uc2Uuc2l6ZSk7CiAgICAgIGtmcmVlKHRwbV9yZXNwb25zZS5kYXRhKTsKICAgICAgdHBtX3Jlc3BvbnNlLmRhdGEgPSBOVUxMOwogICAgfSBlbHNlIHsKICAgICAgdHBtX3Jlc3BvbnNlLnNpemUgPSAwOwogICAgICB0cG1fcmVzcG9uc2UuZGF0YSA9IE5VTEw7CiAgICB9CiAgICB1cCgmdHBtX211dGV4KTsKICAgIHJldHVybiB0cG1fcmVzcG9uc2Uuc2l6ZTsKICB9CiAgcmV0dXJuIC0xOwp9CgpzdHJ1Y3QgZmlsZV9vcGVyYXRpb25zIGZvcHMgPSB7CiAgLm93bmVyICAgPSBUSElTX01PRFVMRSwKICAub3BlbiAgICA9IHRwbV9vcGVuLAogIC5yZWxlYXNlID0gdHBtX3JlbGVhc2UsCiAgLnJlYWQgICAgPSB0cG1fcmVhZCwKICAud3JpdGUgICA9IHRwbV93cml0ZSwKICAudW5sb2NrZWRfaW9jdGwgPSA"}],"EXPAND" :[{"data_size":0,"type":"MSG_EXPAND","subtype":"FLOW_TRACE","expand":{"record_num":1,"trace_record":["55c5ce299b107abd9760bb89d4992020087c99505c28360401742b1e3eedfa2e"]}}]}

************************************************************
{ "HEAD":{"tag":"MESG","version":65537,"sender_uuid":"file_dealer","receiver_uuid":":file_client","route":"file_trans","flow":"QUERY","state":"DELIVER","flag":"NULL","ljump":2,"rjump":1,"record_type":"FILE_TRANS","record_subtype":"FILE_DATA","record_num":1,"record_size":0,"expand_num":1,"expand_size":0,"msg_uuid":"253cefa089ff865885656b826f9cb8646dd2111265b0ae131181d73c8b8eedd5"},"RECORD":[{"uuid":"2845f3d2635bf80b69e1c127ec4c41aa8e35531f91b7ff5d8170a552e0743962","filename":"tpmd_dev.c","total_size":8463,"record_no":13,"offset":6656,"data_size":512,"policy_data":"bV9yZXNwb25zZS5kYXRhID0gTlVMTDsKICB9CiAgdXAoJnRwbV9tdXRleCk7CiAgcmV0dXJuIGNvdW50Owp9CgojZGVmaW5lIFRQTUlPQ19DQU5DRUwgICBfSU8oJ1QnLCAweDAwKQojZGVmaW5lIFRQTUlPQ19UUkFOU01JVCBfSU8oJ1QnLCAweDAxKQoKc3RhdGljIGxvbmcgdHBtX2lvY3RsKHN0cnVjdCBmaWxlICpmaWxlLCB1bnNpZ25lZCBpbnQgY21kLCB1bnNpZ25lZCBsb25nIGFyZykKewogIGRlYnVnKCIlcyglZCwgJXApIiwgX19GVU5DVElPTl9fLCBjbWQsIChjaGFyKilhcmcpOwogIGlmIChjbWQgPT0gVFBNSU9DX1RSQU5TTUlUKSB7CiAgICB1aW50MzJfdCBjb3VudCA9IG50b2hsKCoodWludDMyX3QqKShhcmcgKyAyKSk7CiAgICBkb3duKCZ0cG1fbXV0ZXgpOwogICAgaWYgKHRwbV9yZXNwb25zZS5kYXRhICE9IE5VTEwpIHsKICAgICAga2ZyZWUodHBtX3Jlc3BvbnNlLmRhdGEpOwogICAgICB0cG1fcmVzcG9uc2UuZGF0YSA9IE5VTEw7CiAgICB9CiAgICBpZiAodHBtZF9oYW5kbGVfY28"}],"EXPAND" :[{"data_size":0,"type":"MSG_EXPAND","subtype":"FLOW_TRACE","expand":{"record_num":1,"trace_record":["55c5ce299b107abd9760bb89d4992020087c99505c28360401742b1e3eedfa2e"]}}]}

************************************************************
{ "HEAD":{"tag":"MESG","version":65537,"sender_uuid":"file_dealer","receiver_uuid":":file_client","route":"file_trans","flow":"QUERY","state":"DELIVER","flag":"NULL","ljump":2,"rjump":1,"record_type":"FILE_TRANS","record_subtype":"FILE_DATA","record_num":1,"record_size":0,"expand_num":1,"expand_size":0,"msg_uuid":"253cefa089ff865885656b826f9cb8646dd2111265b0ae131181d73c8b8eedd5"},"RECORD":[{"uuid":"2845f3d2635bf80b69e1c127ec4c41aa8e35531f91b7ff5d8170a552e0743962","filename":"tpmd_dev.c","total_size":8463,"record_no":12,"offset":6144,"data_size":512,"policy_data":"cG1fcmVzcG9uc2Uuc2l6ZSA9PSAoc2l6ZV90KSpwcG9zKSB7CiAgICAgIGtmcmVlKHRwbV9yZXNwb25zZS5kYXRhKTsKICAgICAgdHBtX3Jlc3BvbnNlLmRhdGEgPSBOVUxMOwogICAgfQogIH0gZWxzZSB7CiAgICBjb3VudCA9IDA7CiAgfQogIHVwKCZ0cG1fbXV0ZXgpOwogIHJldHVybiBjb3VudDsKfQoKc3RhdGljIHNzaXplX3QgdHBtX3dyaXRlKHN0cnVjdCBmaWxlICpmaWxlLCBjb25zdCBjaGFyICpidWYsIHNpemVfdCBjb3VudCwgbG9mZl90ICpwcG9zKQp7CiAgZGVidWcoIiVzKCV6ZCkiLCBfX0ZVTkNUSU9OX18sIGNvdW50KTsKICBkb3duKCZ0cG1fbXV0ZXgpOwogICpwcG9zID0gMDsKICBpZiAodHBtX3Jlc3BvbnNlLmRhdGEgIT0gTlVMTCkgewogICAga2ZyZWUodHBtX3Jlc3BvbnNlLmRhdGEpOwogICAgdHBtX3Jlc3BvbnNlLmRhdGEgPSBOVUxMOwogIH0KICBpZiAodHBtZF9oYW5kbGVfY29tbWFuZChidWYsIGNvdW50KSAhPSAwKSB7IAogICAgY291bnQgPSAtRUlMU0VROwogICAgdHA"}],"EXPAND" :[{"data_size":0,"type":"MSG_EXPAND","subtype":"FLOW_TRACE","expand":{"record_num":1,"trace_record":["55c5ce299b107abd9760bb89d4992020087c99505c28360401742b1e3eedfa2e"]}}]}

************************************************************
{ "HEAD":{"tag":"MESG","version":65537,"sender_uuid":"file_dealer","receiver_uuid":":file_client","route":"file_trans","flow":"QUERY","state":"DELIVER","flag":"NULL","ljump":2,"rjump":1,"record_type":"FILE_TRANS","record_subtype":"FILE_DATA","record_num":1,"record_size":0,"expand_num":1,"expand_size":0,"msg_uuid":"253cefa089ff865885656b826f9cb8646dd2111265b0ae131181d73c8b8eedd5"},"RECORD":[{"uuid":"2845f3d2635bf80b69e1c127ec4c41aa8e35531f91b7ff5d8170a552e0743962","filename":"tpmd_dev.c","total_size":8463,"record_no":11,"offset":5632,"data_size":512,"policy_data":"bV9yZXNwb25zZS5kYXRhKTsKICAgIHRwbV9yZXNwb25zZS5kYXRhID0gTlVMTDsKICB9Ci8vICB0cG1kX2Rpc2Nvbm5lY3QoKTsKICB1cCgmdHBtX211dGV4KTsKICBjbGVhcl9iaXQoVFBNX1NUQVRFX0lTX09QRU4sICh2b2lkKikmbW9kdWxlX3N0YXRlKTsKICByZXR1cm4gMDsKfQoKc3RhdGljIHNzaXplX3QgdHBtX3JlYWQoc3RydWN0IGZpbGUgKmZpbGUsIGNoYXIgKmJ1Ziwgc2l6ZV90IGNvdW50LCBsb2ZmX3QgKnBwb3MpCnsKICBkZWJ1ZygiJXMoJXpkKSIsIF9fRlVOQ1RJT05fXywgY291bnQpOwogIGRvd24oJnRwbV9tdXRleCk7CiAgaWYgKHRwbV9yZXNwb25zZS5kYXRhICE9IE5VTEwpIHsKICAgIGNvdW50ID0gbWluKGNvdW50LCAoc2l6ZV90KXRwbV9yZXNwb25zZS5zaXplIC0gKHNpemVfdCkqcHBvcyk7CiAgICBjb3VudCAtPSBjb3B5X3RvX3VzZXIoYnVmLCAmdHBtX3Jlc3BvbnNlLmRhdGFbKnBwb3NdLCBjb3VudCk7CiAgICAqcHBvcyArPSBjb3VudDsKICAgIGlmICgoc2l6ZV90KXQ"}],"EXPAND" :[{"data_size":0,"type":"MSG_EXPAND","subtype":"FLOW_TRACE","expand":{"record_num":1,"trace_record":["55c5ce299b107abd9760bb89d4992020087c99505c28360401742b1e3eedfa2e"]}}]}

************************************************************
{ "HEAD":{"tag":"MESG","version":65537,"sender_uuid":"file_dealer","receiver_uuid":":file_client","route":"file_trans","flow":"QUERY","state":"DELIVER","flag":"NULL","ljump":2,"rjump":1,"record_type":"FILE_TRANS","record_subtype":"FILE_DATA","record_num":1,"record_size":0,"expand_num":1,"expand_size":0,"msg_uuid":"253cefa089ff865885656b826f9cb8646dd2111265b0ae131181d73c8b8eedd5"},"RECORD":[{"uuid":"2845f3d2635bf80b69e1c127ec4c41aa8e35531f91b7ff5d8170a552e0743962","filename":"tpmd_dev.c","total_size":8463,"record_no":10,"offset":5120,"data_size":512,"policy_data":"SVNfT1BFTiwgKHZvaWQqKSZtb2R1bGVfc3RhdGUpKSByZXR1cm4gLUVCVVNZOwogIGRvd24oJnRwbV9tdXRleCk7CgoKICByZXMgPSB0cG1kX2Nvbm5lY3QodHBtZF9zb2NrZXRfbmFtZSx0cG1kX3BvcnQpOwogIHVwKCZ0cG1fbXV0ZXgpOwogIGlmIChyZXMgIT0gMCkgewogICAgY2xlYXJfYml0KFRQTV9TVEFURV9JU19PUEVOLCAodm9pZCopJm1vZHVsZV9zdGF0ZSk7CiAgICByZXR1cm4gLUVJTzsKICB9Ci8vIGNsb3NlIGRldmljZSBzdGFydAogIGRvd24oJnRwbV9tdXRleCk7CiAgdHBtZF9kaXNjb25uZWN0KCk7CiAgdXAoJnRwbV9tdXRleCk7CiAvLyBjbG9zZSBkZXZpY2UgZW5kCiAgcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbnQgdHBtX3JlbGVhc2Uoc3RydWN0IGlub2RlICppbm9kZSwgc3RydWN0IGZpbGUgKmZpbGUpCnsKICBkZWJ1ZygiJXMoKSIsIF9fRlVOQ1RJT05fXyk7CiAgZG93bigmdHBtX211dGV4KTsKICBpZiAodHBtX3Jlc3BvbnNlLmRhdGEgIT0gTlVMTCkgewogICAga2ZyZWUodHA"}],"EXPAND" :[{"data_size":0,"type":"MSG_EXPAND","subtype":"FLOW_TRACE","expand":{"record_num":1,"trace_record":["55c5ce299b107abd9760bb89d4992020087c99505c28360401742b1e3eedfa2e"]}}]}

************************************************************
{ "HEAD":{"tag":"MESG","version":65537,"sender_uuid":"file_dealer","receiver_uuid":":file_client","route":"file_trans","flow":"QUERY","state":"DELIVER","flag":"NULL","ljump":2,"rjump":1,"record_type":"FILE_TRANS","record_subtype":"FILE_DATA","record_num":1,"record_size":0,"expand_num":1,"expand_size":0,"msg_uuid":"253cefa089ff865885656b826f9cb8646dd2111265b0ae131181d73c8b8eedd5"},"RECORD":[{"uuid":"2845f3d2635bf80b69e1c127ec4c41aa8e35531f91b7ff5d8170a552e0743962","filename":"tpmd_dev.c","total_size":8463,"record_no":9,"offset":4608,"data_size":512,"policy_data":"aW92ID0gJmlvdjsKICBtc2cubXNnX2lvdmxlbiA9IDE7CiAgb2xkbW0gPSBnZXRfZnMoKTsKICBzZXRfZnMoS0VSTkVMX0RTKTsKICByZXMgPSBzb2NrX3JlY3Ztc2codHBtZF9zb2NrLCAmbXNnLCB0cG1fcmVzcG9uc2Uuc2l6ZSwgMCk7CiAgc2V0X2ZzKG9sZG1tKTsKICBpZiAocmVzIDwgMCkgewogICAgZXJyb3IoInNvY2tfcmVjdm1zZygpIGZhaWxlZDogJWRcbiIsIHJlcyk7CiAgICB0cG1fcmVzcG9uc2UuZGF0YSA9IE5VTEw7CiAgICByZXR1cm4gcmVzOwogIH0KICB0cG1fcmVzcG9uc2Uuc2l6ZSA9IHJlczsKCi8vIGNsb3NlIGRldmljZSBzdGFydAogIHRwbWRfZGlzY29ubmVjdCgpOwogLy8gY2xvc2UgZGV2aWNlIGVuZAoKICByZXR1cm4gMDsKfQoKc3RhdGljIGludCB0cG1fb3BlbihzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZSAqZmlsZSkKewogIGludCByZXM7CiAgZGVidWcoIiVzKCkiLCBfX0ZVTkNUSU9OX18pOwogIGlmICh0ZXN0X2FuZF9zZXRfYml0KFRQTV9TVEFURV8"}],"EXPAND" :[{"data_size":0,"type":"MSG_EXPAND","subtype":"FLOW_TRACE","expand":{"record_num":1,"trace_record":["55c5ce299b107abd9760bb89d4992020087c99505c28360401742b1e3eedfa2e"]}}]}

************************************************************
{ "HEAD":{"tag":"MESG","version":65537,"sender_uuid":"file_dealer","receiver_uuid":":file_client","route":"file_trans","flow":"QUERY","state":"DELIVER","flag":"NULL","ljump":2,"rjump":1,"record_type":"FILE_TRANS","record_subtype":"FILE_DATA","record_num":1,"record_size":0,"expand_num":1,"expand_size":0,"msg_uuid":"253cefa089ff865885656b826f9cb8646dd2111265b0ae131181d73c8b8eedd5"},"RECORD":[{"uuid":"2845f3d2635bf80b69e1c127ec4c41aa8e35531f91b7ff5d8170a552e0743962","filename":"tpmd_dev.c","total_size":8463,"record_no":8,"offset":4096,"data_size":512,"policy_data":"dm9pZCopaW47CiAgaW92Lmlvdl9sZW4gPSBpbl9zaXplOwogIG1zZy5tc2dfaW92ID0gJmlvdjsKICBtc2cubXNnX2lvdmxlbiA9IDE7CiAgcmVzID0gc29ja19zZW5kbXNnKHRwbWRfc29jaywgJm1zZywgaW5fc2l6ZSk7CiAgaWYgKHJlcyA8IDApIHsKICAgIGVycm9yKCJzb2NrX3NlbmRtc2coKSBmYWlsZWQ6ICVkXG4iLCByZXMpOwogICAgcmV0dXJuIHJlczsKICB9CiAgLyogcmVjZWl2ZSByZXNwb25zZSBmcm9tIHRwbWQgKi8KICB0cG1fcmVzcG9uc2Uuc2l6ZSA9IFRQTV9DTURfQlVGX1NJWkU7CiAgdHBtX3Jlc3BvbnNlLmRhdGEgPSBrbWFsbG9jKHRwbV9yZXNwb25zZS5zaXplLCBHRlBfS0VSTkVMKTsKICBpZiAodHBtX3Jlc3BvbnNlLmRhdGEgPT0gTlVMTCkgcmV0dXJuIC0xOwogIG1lbXNldCgmbXNnLCAwLCBzaXplb2YobXNnKSk7CiAgaW92Lmlvdl9iYXNlID0gKHZvaWQqKXRwbV9yZXNwb25zZS5kYXRhOwogIGlvdi5pb3ZfbGVuID0gdHBtX3Jlc3BvbnNlLnNpemU7CiAgbXNnLm1zZ18"}],"EXPAND" :[{"data_size":0,"type":"MSG_EXPAND","subtype":"FLOW_TRACE","expand":{"record_num":1,"trace_record":["55c5ce299b107abd9760bb89d4992020087c99505c28360401742b1e3eedfa2e"]}}]}

************************************************************
{ "HEAD":{"tag":"MESG","version":65537,"sender_uuid":"file_dealer","receiver_uuid":":file_client","route":"file_trans","flow":"QUERY","state":"DELIVER","flag":"NULL","ljump":2,"rjump":1,"record_type":"FILE_TRANS","record_subtype":"FILE_DATA","record_num":1,"record_size":0,"expand_num":1,"expand_size":0,"msg_uuid":"253cefa089ff865885656b826f9cb8646dd2111265b0ae131181d73c8b8eedd5"},"RECORD":[{"uuid":"2845f3d2635bf80b69e1c127ec4c41aa8e35531f91b7ff5d8170a552e0743962","filename":"tpmd_dev.c","total_size":8463,"record_no":7,"offset":3584,"data_size":512,"policy_data":"ZWxlYXNlKHRwbWRfc29jayk7CiAgICB0cG1kX3NvY2sgPSBOVUxMOwogICAgcmV0dXJuIHJlczsKICB9CiAgcmV0dXJuIDA7Cn0KCnN0YXRpYyB2b2lkIHRwbWRfZGlzY29ubmVjdCh2b2lkKQp7CiAgaWYgKHRwbWRfc29jayAhPSBOVUxMKSB0cG1kX3NvY2stPm9wcy0+cmVsZWFzZSh0cG1kX3NvY2spOwogIHRwbWRfc29jayA9IE5VTEw7Cn0KCnN0YXRpYyBpbnQgdHBtZF9oYW5kbGVfY29tbWFuZChjb25zdCB1aW50OF90ICppbiwgdWludDMyX3QgaW5fc2l6ZSkKewogIGludCByZXM7CiAgbW1fc2VnbWVudF90IG9sZG1tOwogIHN0cnVjdCBtc2doZHIgbXNnOwogIHN0cnVjdCBpb3ZlYyBpb3Y7CgovLyBvcGVuIGRldmljZSBzdGFydAogIHJlcyA9IHRwbWRfY29ubmVjdCh0cG1kX3NvY2tldF9uYW1lLHRwbWRfcG9ydCk7CiAvLyBvcGVuIGRldmljZSBlbmQKCiAgLyogc2VuZCBjb21tYW5kIHRvIHRwbWQgKi8KICBtZW1zZXQoJm1zZywgMCwgc2l6ZW9mKG1zZykpOwogIGlvdi5pb3ZfYmFzZSA9ICg"}],"EXPAND" :[{"data_size":0,"type":"MSG_EXPAND","subtype":"FLOW_TRACE","expand":{"record_num":1,"trace_record":["55c5ce299b107abd9760bb89d4992020087c99505c28360401742b1e3eedfa2e"]}}]}

************************************************************
{ "HEAD":{"tag":"MESG","version":65537,"sender_uuid":"file_dealer","receiver_uuid":":file_client","route":"file_trans","flow":"QUERY","state":"DELIVER","flag":"NULL","ljump":2,"rjump":1,"record_type":"FILE_TRANS","record_subtype":"FILE_DATA","record_num":1,"record_size":0,"expand_num":1,"expand_size":0,"msg_uuid":"253cefa089ff865885656b826f9cb8646dd2111265b0ae131181d73c8b8eedd5"},"RECORD":[{"uuid":"2845f3d2635bf80b69e1c127ec4c41aa8e35531f91b7ff5d8170a552e0743962","filename":"tpmd_dev.c","total_size":8463,"record_no":6,"offset":3072,"data_size":512,"policy_data":"T0NLRVRfTkFNRSk7CiAgdHBtX2FkZHItPnNpbl9hZGRyLnNfYWRkcj1pbl9hdG9uKHNvY2tldF9uYW1lKTsKICB0cG1fYWRkci0+c2luX3BvcnQ9aHRvbnMocG9ydCk7CiAgbWVtc2V0KCYodHBtX2FkZHItPnNpbl96ZXJvKSwnXDAnLDgpOwovLyAgc3RybmNweShhZGRyLnN1bl9wYXRoLCBzb2NrZXRfbmFtZSwgc2l6ZW9mKGFkZHIuc3VuX3BhdGgpKTsKLy8gIHN0cm5jcHkoYWRkci5zYV9kYXRhLCAmdHBtX2FkZHIsIHNpemVvZihhZGRyLnNhX2RhdGEpKTsKICByZXMgPSB0cG1kX3NvY2stPm9wcy0+Y29ubmVjdCh0cG1kX3NvY2ssIAogICAgKHN0cnVjdCBzb2NrYWRkciopJmFkZHIsIHNpemVvZihzdHJ1Y3Qgc29ja2FkZHIpLCAwKTsKLy8gICAgKHN0cnVjdCBzb2NrYWRkciopJmFkZHIsIHNpemVvZihzdHJ1Y3Qgc29ja2FkZHJfdW4pLCAwKTsKICBpZiAocmVzICE9IDApIHsKICAgIGVycm9yKCJzb2NrX2Nvbm5lY3QoKSBmYWlsZWQ6ICVkXG4iLCByZXMpOwogICAgdHBtZF9zb2NrLT5vcHMtPnI"}],"EXPAND" :[{"data_size":0,"type":"MSG_EXPAND","subtype":"FLOW_TRACE","expand":{"record_num":1,"trace_record":["55c5ce299b107abd9760bb89d4992020087c99505c28360401742b1e3eedfa2e"]}}]}

************************************************************
{ "HEAD":{"tag":"MESG","version":65537,"sender_uuid":"file_dealer","receiver_uuid":":file_client","route":"file_trans","flow":"QUERY","state":"DELIVER","flag":"NULL","ljump":2,"rjump":1,"record_type":"FILE_TRANS","record_subtype":"FILE_DATA","record_num":1,"record_size":0,"expand_num":1,"expand_size":0,"msg_uuid":"253cefa089ff865885656b826f9cb8646dd2111265b0ae131181d73c8b8eedd5"},"RECORD":[{"uuid":"2845f3d2635bf80b69e1c127ec4c41aa8e35531f91b7ff5d8170a552e0743962","filename":"tpmd_dev.c","total_size":8463,"record_no":5,"offset":2560,"data_size":512,"policy_data":"aWMgaW50IHRwbWRfY29ubmVjdChjaGFyICpzb2NrZXRfbmFtZSxpbnQgcG9ydCkKewogIGludCByZXM7CiAgc3RydWN0IHNvY2thZGRyX2luICogdHBtX2FkZHI7Ci8vICByZXMgPSBzb2NrX2NyZWF0ZShQRl9VTklYLCBTT0NLX1NUUkVBTSwgMCwgJnRwbWRfc29jayk7CiAgcmVzID0gc29ja19jcmVhdGUoUEZfSU5FVCwgU09DS19TVFJFQU0sIDAsICZ0cG1kX3NvY2spOwogIGlmIChyZXMgIT0gMCkgewogICAgZXJyb3IoInNvY2tfY3JlYXRlKCkgZmFpbGVkOiAlZFxuIiwgcmVzKTsKICAgIHRwbWRfc29jayA9IE5VTEw7CiAgICByZXR1cm4gcmVzOwogIH0KLy8gIGFkZHIuc3VuX2ZhbWlseSA9IEFGX1VOSVg7CiAgdHBtX2FkZHIgPShzdHJ1Y3Qgc29ja2FkZHJfaW4gKikmYWRkcjsKICB0cG1fYWRkci0+c2luX2ZhbWlseT1BRl9JTkVUOwovLyAgdHBtX2FkZHItPnNpbl9wb3J0PWh0b25zKFRQTV9TT0NLRVRfUE9SVCk7Ci8vICB0cG1fYWRkci0+c2luX2FkZHIuc19hZGRyPWluX2F0b24oVFBNX1M"}],"EXPAND" :[{"data_size":0,"type":"MSG_EXPAND","subtype":"FLOW_TRACE","expand":{"record_num":1,"trace_record":["55c5ce299b107abd9760bb89d4992020087c99505c28360401742b1e3eedfa2e"]}}]}

************************************************************
{ "HEAD":{"tag":"MESG","version":65537,"sender_uuid":"file_dealer","receiver_uuid":":file_client","route":"file_trans","flow":"QUERY","state":"DELIVER","flag":"NULL","ljump":2,"rjump":1,"record_type":"FILE_TRANS","record_subtype":"FILE_DATA","record_num":1,"record_size":0,"expand_num":1,"expand_size":0,"msg_uuid":"253cefa089ff865885656b826f9cb8646dd2111265b0ae131181d73c8b8eedd5"},"RECORD":[{"uuid":"2845f3d2635bf80b69e1c127ec4c41aa8e35531f91b7ff5d8170a552e0743962","filename":"tpmd_dev.c","total_size":8463,"record_no":4,"offset":2048,"data_size":512,"policy_data":"TU9EVUxFX1BBUk1fREVTQyh0cG1kX3NvY2tldF9uYW1lLCAiIFNldHMgdGhlIG5hbWUgb2YgdGhlIFRQTSBkYWVtb24gc29ja2V0LiIpOwoKaW50IHRwbWRfcG9ydD02NTQzOwptb2R1bGVfcGFyYW0odHBtZF9wb3J0LCBpbnQsIDA0NDQpOwpNT0RVTEVfUEFSTV9ERVNDKHRwbWRfcG9ydCwgIiBTZXRzIHRoZSBwb3J0IG51bWJlciBvZiB0aGUgVFBNIGRhZW1vbiBzb2NrZXQuIik7Ci8qIFRQTSBsb2NrICovCnN0YXRpYyBzdHJ1Y3Qgc2VtYXBob3JlIHRwbV9tdXRleDsKCi8qIFRQTSBjb21tYW5kIHJlc3BvbnNlICovCnN0YXRpYyBzdHJ1Y3QgewogIHVpbnQ4X3QgKmRhdGE7CiAgdWludDMyX3Qgc2l6ZTsKfSB0cG1fcmVzcG9uc2U7CgovKiBtb2R1bGUgc3RhdGUgKi8Kc3RhdGljIHVpbnQzMl90IG1vZHVsZV9zdGF0ZTsKc3RhdGljIHN0cnVjdCBzb2NrZXQgKnRwbWRfc29jazsKLy9zdGF0aWMgc3RydWN0IHNvY2thZGRyX3VuIGFkZHI7CnN0YXRpYyBzdHJ1Y3Qgc29ja2FkZHIgYWRkcjsKCnN0YXQ"}],"EXPAND" :[{"data_size":0,"type":"MSG_EXPAND","subtype":"FLOW_TRACE","expand":{"record_num":1,"trace_record":["55c5ce299b107abd9760bb89d4992020087c99505c28360401742b1e3eedfa2e"]}}]}

************************************************************
{ "HEAD":{"tag":"MESG","version":65537,"sender_uuid":"file_dealer","receiver_uuid":":file_client","route":"file_trans","flow":"QUERY","state":"DELIVER","flag":"NULL","ljump":2,"rjump":1,"record_type":"FILE_TRANS","record_subtype":"FILE_DATA","record_num":1,"record_size":0,"expand_num":1,"expand_size":0,"msg_uuid":"253cefa089ff865885656b826f9cb8646dd2111265b0ae131181d73c8b8eedd5"},"RECORD":[{"uuid":"2845f3d2635bf80b69e1c127ec4c41aa8e35531f91b7ff5d8170a552e0743962","filename":"tpmd_dev.c","total_size":8463,"record_no":3,"offset":1536,"data_size":512,"policy_data":"ICAgICAgICAgICAgICAgICAgICAgIFRQTV9NT0RVTEVfTkFNRSwgX19GSUxFX18sIF9fTElORV9fLCAjIyBfX1ZBX0FSR1NfXykKI2RlZmluZSBhbGVydChmbXQsIC4uLikgcHJpbnRrKEtFUk5fQUxFUlQgIiVzICVzOiVkOiBBbGVydDogIiBmbXQgIlxuIiwgXAogICAgICAgICAgICAgICAgICAgICAgICBUUE1fTU9EVUxFX05BTUUsIF9fRklMRV9fLCBfX0xJTkVfXywgIyMgX19WQV9BUkdTX18pCgpNT0RVTEVfTElDRU5TRSgiR1BMIik7Ck1PRFVMRV9BVVRIT1IoIk1hcmlvIFN0cmFzc2VyIDxtYXN0QGdteC5uZXQ+Iik7Ck1PRFVMRV9ERVNDUklQVElPTigiVHJ1c3RlZCBQbGF0Zm9ybSBNb2R1bGUgKFRQTSkgRW11bGF0b3IiKTsKTU9EVUxFX1NVUFBPUlRFRF9ERVZJQ0UoVFBNX0RFVklDRV9JRCk7CgovKiBtb2R1bGUgcGFyYW1ldGVycyAqLwpjaGFyICp0cG1kX3NvY2tldF9uYW1lID0gVFBNX1NPQ0tFVF9OQU1FOwptb2R1bGVfcGFyYW0odHBtZF9zb2NrZXRfbmFtZSwgY2hhcnAsIDA0NDQpOwo"}],"EXPAND" :[{"data_size":0,"type":"MSG_EXPAND","subtype":"FLOW_TRACE","expand":{"record_num":1,"trace_record":["55c5ce299b107abd9760bb89d4992020087c99505c28360401742b1e3eedfa2e"]}}]}

************************************************************
{ "HEAD":{"tag":"MESG","version":65537,"sender_uuid":"file_dealer","receiver_uuid":":file_client","route":"file_trans","flow":"QUERY","state":"DELIVER","flag":"NULL","ljump":2,"rjump":1,"record_type":"FILE_TRANS","record_subtype":"FILE_DATA","record_num":1,"record_size":0,"expand_num":1,"expand_size":0,"msg_uuid":"253cefa089ff865885656b826f9cb8646dd2111265b0ae131181d73c8b8eedd5"},"RECORD":[{"uuid":"2845f3d2635bf80b69e1c127ec4c41aa8e35531f91b7ff5d8170a552e0743962","filename":"tpmd_dev.c","total_size":8463,"record_no":2,"offset":1024,"data_size":512,"policy_data":"X0RFVklDRV9JRCAgICAgInRwbSIKI2RlZmluZSBUUE1fTU9EVUxFX05BTUUgICAidHBtZF9kZXYiCgojZGVmaW5lIFRQTV9TVEFURV9JU19PUEVOIDAKCiNpZmRlZiBERUJVRwojZGVmaW5lIGRlYnVnKGZtdCwgLi4uKSBwcmludGsoS0VSTl9ERUJVRyAiJXMgJXM6JWQ6IERlYnVnOiAiIGZtdCAiXG4iLCBcCiAgICAgICAgICAgICAgICAgICAgICAgIFRQTV9NT0RVTEVfTkFNRSwgX19GSUxFX18sIF9fTElORV9fLCAjIyBfX1ZBX0FSR1NfXykKI2Vsc2UKI2RlZmluZSBkZWJ1ZyhmbXQsIC4uLikKI2VuZGlmCiNkZWZpbmUgaW5mbyhmbXQsIC4uLikgIHByaW50ayhLRVJOX0lORk8gIiVzICVzOiVkOiBJbmZvOiAiIGZtdCAiXG4iLCBcCiAgICAgICAgICAgICAgICAgICAgICAgIFRQTV9NT0RVTEVfTkFNRSwgX19GSUxFX18sIF9fTElORV9fLCAjIyBfX1ZBX0FSR1NfXykKI2RlZmluZSBlcnJvcihmbXQsIC4uLikgcHJpbnRrKEtFUk5fRVJSICIlcyAlczolZDogRXJyb3I6ICIgZm10ICJcbiIsIFwKICA"}],"EXPAND" :[{"data_size":0,"type":"MSG_EXPAND","subtype":"FLOW_TRACE","expand":{"record_num":1,"trace_record":["55c5ce299b107abd9760bb89d4992020087c99505c28360401742b1e3eedfa2e"]}}]}

************************************************************
{ "HEAD":{"tag":"MESG","version":65537,"sender_uuid":"file_dealer","receiver_uuid":":file_client","route":"file_trans","flow":"QUERY","state":"DELIVER","flag":"NULL","ljump":2,"rjump":1,"record_type":"FILE_TRANS","record_subtype":"FILE_DATA","record_num":1,"record_size":0,"expand_num":1,"expand_size":0,"msg_uuid":"253cefa089ff865885656b826f9cb8646dd2111265b0ae131181d73c8b8eedd5"},"RECORD":[{"uuid":"2845f3d2635bf80b69e1c127ec4c41aa8e35531f91b7ff5d8170a552e0743962","filename":"tpmd_dev.c","total_size":8463,"record_no":1,"offset":512,"data_size":512,"policy_data":"TlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQogKiBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgogKgogKiAkSWQ6IHRwbWRfZGV2LmMgNDU5IDIwMTEtMDItMTMgMTY6Mjc6NTVaIG1hc3QgJAogKi8KCiNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4KI2luY2x1ZGUgPGxpbnV4L2tlcm5lbC5oPgojaW5jbHVkZSA8bGludXgvaW5pdC5oPgojaW5jbHVkZSA8bGludXgvbWlzY2RldmljZS5oPgojaW5jbHVkZSA8bGludXgvcG9sbC5oPgojaW5jbHVkZSA8bGludXgvc2xhYi5oPgoKI2luY2x1ZGUgPGxpbnV4L3NvY2tldC5oPgojaW5jbHVkZSA8bGludXgvbmV0Lmg+CiNpbmNsdWRlIDxsaW51eC9pbmV0Lmg+CiNpbmNsdWRlIDxsaW51eC9pbi5oPgojaW5jbHVkZSA8bGludXgvdW4uaD4KCiNpbmNsdWRlICJjb25maWcuaCIKCiNkZWZpbmUgREVCVUcKI2RlZmluZSBUUE1fREVWSUNFX01JTk9SICAyMjQKI2RlZmluZSBUUE0"}],"EXPAND" :[{"data_size":0,"type":"MSG_EXPAND","subtype":"FLOW_TRACE","expand":{"record_num":1,"trace_record":["55c5ce299b107abd9760bb89d4992020087c99505c28360401742b1e3eedfa2e"]}}]}

************************************************************
{ "HEAD":{"tag":"MESG","version":65537,"sender_uuid":"file_dealer","receiver_uuid":":file_client","route":"file_trans","flow":"QUERY","state":"DELIVER","flag":"NULL","ljump":2,"rjump":1,"record_type":"FILE_TRANS","record_subtype":"FILE_DATA","record_num":1,"record_size":0,"expand_num":1,"expand_size":0,"msg_uuid":"253cefa089ff865885656b826f9cb8646dd2111265b0ae131181d73c8b8eedd5"},"RECORD":[{"uuid":"2845f3d2635bf80b69e1c127ec4c41aa8e35531f91b7ff5d8170a552e0743962","filename":"tpmd_dev.c","total_size":8463,"record_no":0,"offset":0,"data_size":512,"policy_data":"LyogU29mdHdhcmUtYmFzZWQgVHJ1c3RlZCBQbGF0Zm9ybSBNb2R1bGUgKFRQTSkgRW11bGF0b3IKICogQ29weXJpZ2h0IChDKSAyMDA0LTIwMTAgTWFyaW8gU3RyYXNzZXIgPG1hc3RAZ214Lm5ldD4KICoKICogVGhpcyBtb2R1bGUgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQogKiBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZAogKiBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLAogKiBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgogKgogKiBUaGlzIG1vZHVsZSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAogKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgogKiBNRVJDSEE"}],"EXPAND" :[{"data_size":0,"type":"MSG_EXPAND","subtype":"FLOW_TRACE","expand":{"record_num":1,"trace_record":["55c5ce299b107abd9760bb89d4992020087c99505c28360401742b1e3eedfa2e"]}}]}

************************************************************
{ "HEAD":{"tag":"MESG","version":65537,"sender_uuid":"connector_proc","receiver_uuid":"","route":"","flow":"FINISH","state":"INIT","flag":"NULL","ljump":1,"rjump":1,"record_type":"MESSAGE","record_subtype":"CONN_SYNI","record_num":1,"record_size":95,"expand_num":0,"expand_size":0,"msg_uuid":"3d4146611cf0b425606d21df4e5ad3b836a83156b18c53b94a8be8ee163d36e9"},"RECORD":[{"uuid":"a62f059a886df1d5e7bf037ef89cce78c7addf3388093583d446c5b14306864f","server_name":"file_receiver","service":"trust_server","server_addr":"","flags":0,"nonce":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"}],"EXPAND" :[]}

************************************************************
{ "HEAD":{"tag":"MESG","version":65537,"sender_uuid":"connector_proc","receiver_uuid":"request","route":"file_trans","flow":"QUERY","state":"DELIVER","flag":"LOCAL|RESPONSE","ljump":3,"rjump":3,"record_type":"FILE_TRANS","record_subtype":"NOTICE","record_num":1,"record_size":47,"expand_num":0,"expand_size":0,"msg_uuid":"253cefa089ff865885656b826f9cb8646dd2111265b0ae131181d73c8b8eedd5"},"RECORD":[{"uuid":"2845f3d2635bf80b69e1c127ec4c41aa8e35531f91b7ff5d8170a552e0743962","filename":"tpmd_dev.c","result":1}],"EXPAND" :[]}

************************************************************
